(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,a){},173:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(15),o=a.n(i),l=(a(102),a(42)),c=a(12),s=a(8),u=a(10),m=a(11),d=a(28),f=a.n(d),p=a(25),h=a(43),y=a.n(h),g=a(37),b=a.n(g),v=a(46),E=a.n(v),k=a(18),x=a.n(k),w=a(16),O=a.n(w),j=a(31),_=a.n(j),S=a(61);function T(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=a.length,r=0;r<e;r++)t+=a.charAt(Math.floor(Math.random()*n));return t}function P(e,t){for(var a=[],n=0;n<e.length;n+=t)a=[].concat(Object(c.a)(a),[e.slice(n,n+t)]);return a}function N(e,t){return e.reduce(function(e,a){return e[a[t]]=a,e},{})}var C=function(e){var t,a=e.onTokenChange,n=window.location.hash,i=r.a.createElement(r.a.Fragment,null);if(""===n){var o=T(16);localStorage.setItem("spotify-auth-random-state",o);var l={client_id:S.spotify_client_id,response_type:"token",redirect_uri:window.location.href,state:o,scope:S.spotify_premission_scope,show_dialog:!0},c=(t=l,Object.keys(t).map(function(e){return[e,t[e]].map(encodeURIComponent).join("=")}).join("&"));window.location.href="https://accounts.spotify.com/authorize?"+c,i=r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{animation:"border"}),r.a.createElement("p",{className:"lead"},"Requesting token, you will be redirected to Spotify"))}else{var s=new URLSearchParams(n.substr(1)),u=s.get("access_token"),d=s.get("expires_in"),f=s.get("state");if(null!==u&&null!==d&&null!==f){var p=localStorage.getItem("spotify-auth-random-state");null!==p&&p===f?(localStorage.removeItem("spotify-auth-random-state"),function(e,t){var n=new Date;n.setSeconds(n.getSeconds()+t),a({value:e,expiry:n})}(u,parseInt(d)),function(){var e=localStorage.getItem("auth-local-redirect");null===e?Object(m.navigate)("/"):(localStorage.removeItem("auth-local-redirect"),Object(m.navigate)(e))}(),i=r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{animation:"border"}),r.a.createElement("p",{className:"lead"},"Recieved token"))):i=r.a.createElement("p",{className:"lead"},"Token not requested by this application")}else i=r.a.createElement("p",{className:"lead"},"Incorrect URL parameters")}return r.a.createElement(x.a,{className:"text-center"},r.a.createElement("h1",null,"Spotify Authorization"),i)},A=a(91),I=a.n(A),L=function(e){var t=e.user,a=e.onLoggedInClick,n=Object(m.usePath)();return r.a.createElement(O.a,{variant:"outline-secondary",onClick:function(){void 0===t?(localStorage.setItem("auth-local-redirect",n),Object(m.navigate)("/spotify-authorization")):a()}},r.a.createElement("img",{src:void 0!==t&&void 0!==t.images&&t.images.length>0?t.images[0].url:I.a,alt:void 0!==t&&void 0!==t.images&&t.images.length>0?t.display_name+" Logo":"Spotify Logo Round",style:{height:20,width:20,borderRadius:"50%"},className:"mr-2"}),void 0!==t&&void 0!==t.images&&t.images.length>0?t.display_name:"Sign In With Spotify")},F={"/":"Home","/sort":"Sort","/about":"About"},M=function(e){var t=e.user,a=e.onAuthButtonLoggedInClick,n=Object(m.usePath)(),i=function(e){return function(){return Object(m.navigate)(e)}};return r.a.createElement(b.a,{collapseOnSelect:!0,expand:"sm",bg:"light",variant:"light",sticky:"top"},r.a.createElement(x.a,null,r.a.createElement(b.a.Brand,{onClick:i("/")},r.a.createElement("img",{src:y.a,height:"30",className:"d-inline-block align-top",alt:"Emotionify Banner Logo",style:{cursor:"pointer"}})),r.a.createElement(b.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(b.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(E.a,{className:"mr-auto"},Object.keys(F).map(function(e){return r.a.createElement(E.a.Link,{href:"#",onClick:i(e),active:n===e},F[e])})),r.a.createElement(E.a,null,r.a.createElement(L,{user:t,onLoggedInClick:a})))))},W=a(20),B=a.n(W),H=function(e){var t=e.token,a=e.onLogOut,i=Object(n.useState)(!1),o=Object(u.a)(i,2),l=o[0],c=o[1];Object(n.useEffect)(function(){var e=[];if(void 0!==t){var a=t.expiry.getTime()-(new Date).getTime();3e5<a?(e.push(setTimeout(function(){c(!0)},a-3e5)),e.push(setTimeout(function(){c(!0)},a))):a>0?(e.push(setTimeout(function(){c(!0)},a)),c(!0)):c(!0)}return function(){return e.forEach(function(e){return clearTimeout(e)})}},[t]);var s=function(){return c(!1)};if(void 0!==t&&l){var d=t.expiry.getTime()-(new Date).getTime()<=0;return r.a.createElement(B.a,{show:l,onHide:s},r.a.createElement(B.a.Header,{closeButton:!0},r.a.createElement(B.a.Title,null,d?"Spotify Token Expired":"Spotify Token Refresh Warning")),r.a.createElement(B.a.Body,null,d?r.a.createElement(r.a.Fragment,null,"Your Spotify token has now expired and we can no longer access your data; sign back in with Spotify to get an new token.",r.a.createElement("br",null),"We will leave you logged in here so you can still view your data but we will not be able to get data from Spotify for you."):r.a.createElement(r.a.Fragment,null,"Since Spotify issues client side tokens for upto an hour, you will need a new token soon. Your current token expires at ",t.expiry.toLocaleTimeString(),".",r.a.createElement("br",null),"To do this, we'll send you back to the Spotify authorization page again to get a new token.")),r.a.createElement(B.a.Footer,null,r.a.createElement(O.a,{variant:"secondary",onClick:s},"Close"),r.a.createElement(O.a,{variant:"primary",onClick:function(){a(),Object(m.navigate)("/spotify-authorization")}},"Refresh Token")))}return r.a.createElement(r.a.Fragment,null)},R=function(e){var t=e.token,a=e.user,n=e.playlists,i=e.tracks,o=e.onClose,l=e.onLogOut,c=t.value.substr(0,10)+"....."+t.value.substr(t.value.length-10,t.value.length),s=Object.values(n).filter(function(e){return e.public}).length,u=Object.values(n).filter(function(e){return!e.public}).length,m=Object.values(i).length;return r.a.createElement(B.a,{show:!0,onHide:o},r.a.createElement(B.a.Header,{closeButton:!0},r.a.createElement(B.a.Title,null,a.display_name)),r.a.createElement(B.a.Body,null,"Data currently stored:",r.a.createElement("ul",{style:{marginBottom:0}},r.a.createElement("li",{title:c},"Token expires at: ",r.a.createElement("code",null,t.expiry.toLocaleTimeString())),r.a.createElement("li",{title:a.uri},"User associated: ",r.a.createElement("code",null,a.display_name)),r.a.createElement("li",null,"Playlists stored: ",r.a.createElement("code",null,s," public and ",u," private")),r.a.createElement("li",null,"Tracks stored (with audio features): ",r.a.createElement("code",null,m)))),r.a.createElement(B.a.Footer,null,r.a.createElement(O.a,{variant:"outline-secondary",onClick:o},"Close"),r.a.createElement(O.a,{variant:"outline-secondary",onClick:l},"Logout")))},Y=a(92),D=a.n(Y),z=function(e){Object(m.useTitle)("Emotionify");return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"jumbotron jumbotron-fluid text-center"},r.a.createElement(x.a,null,r.a.createElement("h1",{className:"sr-only"},"Emotionify"),r.a.createElement("img",{src:y.a,className:"mb-2",style:{width:800,maxWidth:"100%"},alt:"Emotionify Banner Logo"}),r.a.createElement("p",{className:"lead col-md-7 mt-2 mx-auto"},"Easily create emotionally gradiented Spotify playlists for smoother emotional transitions in your listening"))),r.a.createElement("section",null,r.a.createElement(x.a,{style:{textAlign:"center",marginBottom:40}},r.a.createElement("h2",null,"Sort Your Playlist"),r.a.createElement("img",{src:D.a,alt:"Emotionify Sort Comparison",style:{maxWidth:"100%",width:900}}),r.a.createElement("div",{style:{maxWidth:800,margin:"30px auto"}},r.a.createElement("p",{className:"lead"},"Using features calculated by Spotify for each song, sort your playlist on an emotional gradient."),r.a.createElement("p",{className:"lead"},"You can also change how and what your songs are sorted by to explore different methods of sorting playlists and discover new ways to listen to your playlists.")),r.a.createElement(O.a,{variant:"outline-dark",onClick:function(){return Object(m.navigate)("/sort")}},"Sort My Playlist \u2192"))))},U=a(93),V=a.n(U),X=a(94),K=a.n(X),q=function(e){return Object(m.useTitle)("Emotionify - About"),r.a.createElement(x.a,null,r.a.createElement(V.a,{className:"justify-content-md-center"},r.a.createElement(K.a,{className:"col-md-10 col-lg-8"},r.a.createElement("h1",{className:"text-center"},"About"),r.a.createElement("p",null,"Emotionify is application I had though about for a few years after doing a project at university on attempting to detect emotion in music and portraying it in an interactive environment."),r.a.createElement("p",null,"By default, chosing a playlist on the Sort page will sort your music by ",r.a.createElement("code",null,"Valence")," and ",r.a.createElement("code",null,"Energy")," which are ",r.a.createElement("a",{href:"https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/"},"audio features calculated by Spotify"),". When conducting research for my project, this is was the some of the best public and easily accessible data that related to emotion in music. Also with Spotify being so large and active among many people, it allows for people to easily organise thier own playlists."),r.a.createElement("p",null,"Emotionify is not 100% accurate as emotion is highly opinion based and the values used to sort songs are averages over the whole song. This tool however does give insight on how well a computer can plot an emotional gradient with a list of songs."),r.a.createElement("p",null,"I made this project because I was curious if this data really did mean anything and if my guess of the data being able to be used to sort playlists by emotion was correct. I can leave that up to you to decide!"),r.a.createElement("p",null,"As you can see on the Sort page, I have also made the other audio features avaiable for you to play around with."),r.a.createElement("h2",{className:"text-center"},"Stored Data"),r.a.createElement("p",null,"I am fully tranparent with the data that is stored here and what is done with it. None of your data is sent off this site and when stored, it stored in local storage."),r.a.createElement("p",null,"To view a summary of the stored data, simply click your name in the top right. To clear this data, simply logout using the same dialog that appears."),r.a.createElement("h2",{className:"text-center"},"FAQ"),r.a.createElement("h5",null,"Why is this a thing?"),r.a.createElement("p",null,"I was curious."),r.a.createElement("h5",null,"Will this remove duplicates?"),r.a.createElement("p",null,"Yes, if this tool didn't then the duplicate songs would be bunched up by each other. Removing these allows for proper transitions into a different song."),r.a.createElement("h5",null,"How do I clear all my data?"),r.a.createElement("p",null,"All data is stored in localStorage on your machine; simply logging out will clear all this data."),r.a.createElement("h5",null,"What are each of the audio features I select for the axis?"),r.a.createElement("p",null,"Here are some summaries from ",r.a.createElement("a",{href:"https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/"},"Spotify"),":"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("code",null,"Acousticness"),": A confidence measure from 0 to 1 of whether the track is acoustic. 1 represents high confidence the track is acoustic."),r.a.createElement("li",null,r.a.createElement("code",null,"Danceability"),": Danceability describes how suitable a track is for dancing based on a combination of musical elements. A value of 0 is least danceable and 1 is most danceable."),r.a.createElement("li",null,r.a.createElement("code",null,"Duration"),": The duration of the track in milliseconds."),r.a.createElement("li",null,r.a.createElement("code",null,"Energy"),": Energy is a measure from 0 to 1 and represents a perceptual measure of intensity and activity. Typically, energetic tracks feel fast, loud, and noisy. For example, death metal has high energy, while a Bach prelude scores low on the scale."),r.a.createElement("li",null,r.a.createElement("code",null,"Instrumentalness"),": Predicts whether a track contains no vocals. The closer the instrumentalness value is to 1, the greater likelihood the track contains no vocal content. Values above 0.5 are intended to represent instrumental tracks, but confidence is higher as the value approaches 1."),r.a.createElement("li",null,r.a.createElement("code",null,"Key"),": The estimated overall key of the track. (-1 if no key is detected)"),r.a.createElement("li",null,r.a.createElement("code",null,"Liveness"),": Detects the presence of an audience in the recording. Higher liveness values represent an increased probability that the track was performed live. A value above 0.8 provides strong likelihood that the track is live."),r.a.createElement("li",null,r.a.createElement("code",null,"Loudness"),": The overall loudness of a track in decibels (dB). Loudness values are averaged across the entire track and are useful for comparing relative loudness of tracks. Values typical range between -60 and 0 db."),r.a.createElement("li",null,r.a.createElement("code",null,"Mode"),": Mode indicates the modality (major or minor) of a track, the type of scale from which its melodic content is derived. Major is represented by 1 and minor is 0."),r.a.createElement("li",null,r.a.createElement("code",null,"Speechiness"),": Speechiness detects the presence of spoken words in a track. Talk shows and audio books are closer to 1, songs made entirely of spoken words are above 0.66, songs that contain both music and speech are typically around 0.33 - 0.66 and values below 0.33 represent music and other non-speech-like tracks."),r.a.createElement("li",null,r.a.createElement("code",null,"Tempo"),": The overall estimated tempo of a track in beats per minute (BPM)."),r.a.createElement("li",null,r.a.createElement("code",null,"Time Signature"),": An estimated overall time signature of a track. The time signature (meter) is a notational convention to specify how many beats are in each bar (or measure)."),r.a.createElement("li",null,r.a.createElement("code",null,"Valence"),": A measure from 0 to 1 describing the musical positiveness conveyed by a track. Tracks with high valence sound more positive, while tracks with low valence sound more negative.")))))},J=a(21),G=a.n(J),Q=a(29),Z=a(45),$=a.n(Z),ee={"Distance From Origin":function(e){return e.map(function(e){return Object(s.a)({},e,{distance:te(0,0,e.x,e.y)})}).sort(function(e,t){return e.distance-t.distance})},"Nearest Neighbour":function(e){if(0===e.length)return[];var t=e.reduce(function(e,t){var a=te(0,0,e.x,e.y),n=te(0,0,t.x,t.y);return a>n?t:e}),a=[t],n=e.slice();n=n.filter(function(e){return e.id!==t.id});var r=t,i=function(e,t){var a=te(r.x,r.y,e.x,e.y),n=te(r.x,r.y,t.x,t.y);return a>n?t:e},o=function(){var e=n.reduce(i);a.push(e),n=n.filter(function(t){return t.id!==e.id}),r=e};for(;n.length>0;)o();return a},"X Axis":function(e){return e.sort(function(e,t){return e.x===t.x?0:e.x>t.x?1:-1})},"Y Axis":function(e){return e.sort(function(e,t){return e.y===t.y?0:e.y>t.y?1:-1})},"No Sorting":function(e){return e}};function te(e,t,a,n){var r=e-a,i=t-n;return Math.sqrt(r*r+i*i)}var ae=20,ne=100,re=100,ie=10;function oe(e,t){for(var a=[],n=0,r=0;n<t;r++)a.push({offset:r*e,limit:e}),n+=e;return a}function le(e,t,a,n,r){return new Promise(function(i,o){var l=new f.a;return l.setAccessToken(e),l.createPlaylist(t.id,{name:a,public:n,description:"Created by emotionify.nitratine.net"}).then(function(){var e=Object(Q.a)(G.a.mark(function e(t){var a,n;return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=P(r,100),n=0;case 2:if(!(n<a.length)){e.next=8;break}return e.next=5,l.addTracksToPlaylist(t.id,a[n]).catch(function(e){return o(e)});case 5:n++,e.next=2;break;case 8:t.tracks.total=r.length,i(Object(s.a)({},t,{track_ids:[]}));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),function(e){o(e)})})}var ce={Acousticness:"acousticness",Danceability:"danceability",Duration:"duration_ms",Energy:"energy",Instrumentalness:"instrumentalness",Key:"key",Liveness:"liveness",Loudness:"loudness",Mode:"mode",Speechiness:"speechiness",Tempo:"tempo","Time Signature":"time_signature",Valence:"valence"},se=a(44),ue=a.n(se),me=a(23),de=a.n(me),fe=a(6),pe=a.n(fe),he=a(36),ye=a.n(he),ge=a(24),be=a.n(ge),ve=a(19),Ee=a.n(ve);function ke(){return{innerHeight:window.innerHeight,innerWidth:window.innerWidth,outerHeight:window.outerHeight,outerWidth:window.outerWidth}}var xe=function(e){var t=e.playlists,a=e.selectedPlaylistIds,i=e.multipleSelectionsAllowed,o=e.onPlaylistSelectionChange,l=Object(n.useState)(!0),s=Object(u.a)(l,2),m=s[0],d=s[1],f=Object(n.useState)(""),p=Object(u.a)(f,2),h=p[0],y=p[1],g=function(){var e=Object(n.useState)(ke()),t=Object(u.a)(e,2),a=t[0],r=t[1];function i(){r(ke())}return Object(n.useEffect)(function(){return window.addEventListener("resize",i),function(){window.removeEventListener("resize",i)}},[]),a}(),b=function(e){return function(){e&&a.length>1&&o(a.length>0?[a[0]]:[],!1),d(e)}},v=t.filter(function(e){return-1!==e.name.indexOf(h)||-1!==e.uri.indexOf(h)}).sort(function(e,t){return e.name===t.name?0:e.name>t.name?1:-1});return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"mb-3"},"Select a Playlist"),r.a.createElement("div",{style:{width:700,maxWidth:"100%",margin:"auto"}},r.a.createElement(pe.a,{style:{marginBottom:5}},r.a.createElement(pe.a.Prepend,null,r.a.createElement(pe.a.Text,null,g.innerWidth>576?"Search Playlists":"Search")),r.a.createElement(ye.a,{placeholder:"Playlist name...",value:h,onChange:function(e){return y(e.currentTarget.value)}}),i&&r.a.createElement(be.a,{as:pe.a.Append,variant:"outline-secondary",title:m?"Single":"Multiple",id:"playlist-selection-types",alignRight:!0},r.a.createElement(Ee.a.Item,{onClick:b(!0)},"Single Playlist Selection"),r.a.createElement(Ee.a.Item,{onClick:b(!1)},"Multiple Playlist Selection"))),r.a.createElement("div",{style:{maxHeight:450,overflowX:"auto"}},r.a.createElement(ue.a,{striped:!0,hover:!0},r.a.createElement("tbody",null,v.map(function(e){return r.a.createElement("tr",{key:e.id,onClick:(t=e.id,function(){m||!i?o([t],!0):-1===a.indexOf(t)?o([].concat(Object(c.a)(a),[t]),!1):o(Object(c.a)(a.filter(function(e){return e!==t})),!1)}),style:{cursor:"pointer",background:-1!==a.indexOf(e.id)?"linear-gradient(to right, rgba(0, 82, 157, 0.3), rgba(235, 18, 27, 0.3))":void 0,display:"grid",gridTemplateColumns:"60px 1fr"}},r.a.createElement("td",{style:{padding:2}},e.images.length>0&&r.a.createElement("img",{src:e.images[0].url,style:{width:"100%"},alt:"Artwork for: "+e.name})),r.a.createElement("td",{style:{textAlign:"left",padding:"0 0 0 10px"}},r.a.createElement("div",{style:{fontSize:22}},e.name),r.a.createElement("div",null,r.a.createElement(de.a,{variant:"primary"},e.owner.display_name),r.a.createElement(de.a,{variant:"dark",className:"ml-1"},"Songs: ",e.tracks.total),r.a.createElement(de.a,{variant:"danger",className:"ml-1"},e.public?"Public":"Private"))));var t}))))))},we=function(e){var t=e.playlists,a=e.tracksLoading;if(1===t.length){var n=t[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"mt-4 mb-0"},n.name),r.a.createElement("div",null,r.a.createElement("a",{href:n.owner.external_urls.spotify},r.a.createElement(de.a,{variant:"primary"},n.owner.display_name)),r.a.createElement(de.a,{variant:"dark",className:"ml-1"},"Songs: ",n.tracks.total),r.a.createElement("a",{href:n.external_urls.spotify,className:"ml-1"},r.a.createElement(de.a,{variant:"success"},"Spotify")),r.a.createElement(de.a,{variant:"danger",className:"ml-1"},n.public?"Public":"Private")),a&&r.a.createElement("div",{className:"text-center mt-3"},r.a.createElement(_.a,{animation:"border"})))}return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"mt-4 mb-0"},t.length," Playlist",t.length>1&&"s"," Selected"),r.a.createElement("div",null,r.a.createElement(de.a,{variant:"dark",className:"ml-1"},"Songs: ",t.map(function(e){return e.tracks.total}).reduce(function(e,t){return e+t}))),a&&r.a.createElement("div",{className:"text-center mt-3"},r.a.createElement(_.a,{animation:"border"})))},Oe=a(96),je=a.n(Oe);var _e=function(e){var t=e.tracks,a=e.selected_x_axis,n=e.selected_y_axis,i=e.selected_x_axis_name,o=e.selected_y_axis_name,l=t.map(function(e){var t={id:e.id,title:e.name,artist:e.artists.map(function(e){return e.name}).join(", "),length:e.duration_ms};return void 0!==e.audio_features&&null!==e.audio_features?{x:e.audio_features[a],y:e.audio_features[n],track:t}:void 0===e.audio_features?{x:0,y:0,track:t}:null}).filter(function(e){return null!==e}),s=Math.min.apply(Math,Object(c.a)(l.map(function(e){return e.x}))),u=Math.min.apply(Math,Object(c.a)(l.map(function(e){return e.y}))),m=Math.max.apply(Math,Object(c.a)(l.map(function(e){return e.x}))),d=Math.max.apply(Math,Object(c.a)(l.map(function(e){return e.y})));return r.a.createElement(r.a.Fragment,null,r.a.createElement(je.a,{data:[{y:l.map(function(e){return e.y}),x:l.map(function(e){return e.x}),text:l.map(function(e){return"Title: "+e.track.title+"<br>Artist: "+e.track.artist+"<br>"+i+": "+e.x+"<br>"+o+": "+e.y}),hoverinfo:"text",mode:"lines+markers",marker:{size:10,color:l.map(function(e){return"#"+function(e,t,a){var n=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},r=Math.ceil(parseInt(t.substring(0,2),16)*a+parseInt(e.substring(0,2),16)*(1-a)),i=Math.ceil(parseInt(t.substring(2,4),16)*a+parseInt(e.substring(2,4),16)*(1-a)),o=Math.ceil(parseInt(t.substring(4,6),16)*a+parseInt(e.substring(4,6),16)*(1-a));return n(r)+n(i)+n(o)}("00529d","eb121b",function(e,t,a){var n=t.x-e.x,r=t.y-e.y,i=n*n+r*r,o=(a.x-e.x)*n+(a.y-e.y)*r;return Math.min(1,Math.max(0,o/i))}({x:s,y:u},{x:m,y:d},{x:e.x,y:e.y}))})},line:{color:"rgba(44, 48, 51, 0.5)",width:1}}],layout:{hovermode:"closest",margin:{t:0,b:0,l:0,r:0},plot_bgcolor:"transparent",paper_bgcolor:"transparent"},useResizeHandler:!0,style:{width:"100%",maxWidth:700,height:450,margin:"auto",border:"2px solid #6c757d",overflow:"hidden",borderRadius:10}}),t.filter(function(e){return null===e.audio_features}).length>0&&r.a.createElement($.a,{variant:"warning",className:"mt-2 d-inline-block"},"Warning: Some songs are missing audio features.",r.a.createElement("br",null),"Look in the table below to identify these songs (they will have no values beside them)."))},Se=a(47),Te=a.n(Se),Pe=a(48),Ne=a.n(Pe),Ce={position:"sticky",top:0,background:"white",borderTop:0},Ae=function(e){var t=e.tracks,a=e.x_audio_feature,i=e.x_audio_feature_name,o=e.y_audio_feature,l=e.y_audio_feature_name,c=Object(n.useState)(T(16)),s=Object(u.a)(c,2),m=s[0],d=(s[1],Object(n.useState)(!1)),f=Object(u.a)(d,2),p=f[0],h=f[1];return r.a.createElement(Te.a,{defaultActiveKey:void 0,style:{maxWidth:900,margin:"auto"}},r.a.createElement(Ne.a,null,r.a.createElement(Te.a.Toggle,{as:Ne.a.Header,eventKey:m,onClick:function(){return h(!p)}},p?"Songs in Playlist (click to collapse)":"Songs in Playlist (click to expand)"),r.a.createElement(Te.a.Collapse,{eventKey:m},r.a.createElement(Ne.a.Body,{className:"p-0",style:{maxHeight:400,overflowY:"auto",borderTop:"1px solid #dee2e6"}},r.a.createElement(ue.a,{bordered:!0,striped:!0,size:"sm",style:{borderTop:0}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:Ce},"Moved"),r.a.createElement("th",{style:Ce},"Title"),r.a.createElement("th",{style:Ce,className:"d-none d-md-table-cell"},"Artists"),r.a.createElement("th",{style:Ce},i),r.a.createElement("th",{style:Ce},l))),r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",{style:e.index.after-e.index.before===0?{color:"black"}:e.index.after-e.index.before<0?{color:"green"}:{color:"red"}},e.index.before-e.index.after),r.a.createElement("td",null,e.name),r.a.createElement("td",{className:"d-none d-md-table-cell"},e.artists.map(function(e){return e.name}).join(", ")),r.a.createElement("td",null,void 0!==e.audio_features&&null!==e.audio_features&&e.audio_features[a]),r.a.createElement("td",null,void 0!==e.audio_features&&null!==e.audio_features&&e.audio_features[o]))})))))))},Ie=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{className:"mr-3 mt-1",style:{display:"inline-flex",width:"auto"}},r.a.createElement(pe.a.Prepend,null,r.a.createElement(pe.a.Text,null,"X-Axis")),r.a.createElement(be.a,{as:pe.a.Append,variant:"outline-secondary",title:e.selected_x_axis,id:"X-Axis"},e.available_audio_features.map(function(t){return r.a.createElement(Ee.a.Item,{key:t,onClick:function(){return e.onXAxisSelect(t)}},t)}))),r.a.createElement(pe.a,{className:"mr-3 mt-1",style:{display:"inline-flex",width:"auto"}},r.a.createElement(pe.a.Prepend,null,r.a.createElement(pe.a.Text,null,"Y-Axis")),r.a.createElement(be.a,{as:pe.a.Append,variant:"outline-secondary",title:e.selected_y_axis,id:"Y-Axis"},e.available_audio_features.map(function(t){return r.a.createElement(Ee.a.Item,{key:t,onClick:function(){return e.onYAxisSelect(t)}},t)}))),r.a.createElement(pe.a,{className:"mt-1",style:{display:"inline-flex",width:"auto"}},r.a.createElement(pe.a.Prepend,null,r.a.createElement(pe.a.Text,null,"Sort Method")),r.a.createElement(be.a,{as:pe.a.Append,variant:"outline-secondary",title:e.selected_sorting_method,id:"Sort-Method"},e.available_track_sorting_methods.map(function(t){return r.a.createElement(Ee.a.Item,{key:t,onClick:function(){return e.onSortMethodSelect(t)}},t)}))))},Le=function(e){var t=e.onExport,a=Object(n.useState)(""),i=Object(u.a)(a,2),o=i[0],l=i[1],c=Object(n.useState)(!1),s=Object(u.a)(c,2),m=s[0],d=s[1],f=Object(n.useState)(!1),h=Object(u.a)(f,2),y=h[0],g=h[1],b=function(e){void 0!==e.currentTarget.value&&(l(e.currentTarget.value),g(""===e.currentTarget.value))},v=function(e){return function(){return d(e)}},E=function(){""===o?g(!0):t(o,m).then(function(e){e?(l(""),p.a.success("Playlist has been created. You can go to Spotify to see your new playlist.",{position:"bottom-center",heading:"Playlist Created",hideAfter:10,onClick:function(e){return e()}})):p.a.error("Failed to create playlist. Make sure you are connected to the internet and that your token is valid.",{position:"bottom-center",heading:"Failed To Create Playlist",hideAfter:10,onClick:function(e){return e()}})})};return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"mb-2"},"Create New Playlist"),r.a.createElement(pe.a,{className:"mb-3 d-none d-sm-inline-flex",style:{maxWidth:500}},r.a.createElement(pe.a.Prepend,null,r.a.createElement(pe.a.Text,{id:"playlist-name"},"Playlist Name")),r.a.createElement(ye.a,{placeholder:"Playlist Name","aria-label":"Playlist Name","aria-describedby":"playlist-name",value:o,onChange:b,isInvalid:y}),r.a.createElement(be.a,{as:pe.a.Append,variant:"outline-secondary",title:m?"Public":"Private",id:"make-private"},r.a.createElement(Ee.a.Item,{onClick:v(!1)},"Private"),r.a.createElement(Ee.a.Item,{onClick:v(!0)},"Public")),r.a.createElement(pe.a.Append,null,r.a.createElement(O.a,{variant:"outline-secondary",onClick:E},"Create"))),r.a.createElement(pe.a,{className:"mb-3 d-inline-flex d-sm-none",style:{maxWidth:500,justifyContent:"center"}},r.a.createElement(pe.a.Prepend,null,r.a.createElement(pe.a.Text,{id:"playlist-name"},"Playlist Name")),r.a.createElement(ye.a,{placeholder:"Playlist Name","aria-label":"Playlist Name","aria-describedby":"playlist-name",value:o,onChange:b,isInvalid:y})),r.a.createElement(pe.a,{className:"mb-3 d-inline-flex d-sm-none",style:{maxWidth:500,justifyContent:"center"}},r.a.createElement(be.a,{as:pe.a.Prepend,variant:"outline-secondary",title:m?"Public":"Private",id:"make-private"},r.a.createElement(Ee.a.Item,{onClick:v(!1)},"Private"),r.a.createElement(Ee.a.Item,{onClick:v(!0)},"Public")),r.a.createElement(pe.a.Append,null,r.a.createElement(O.a,{variant:"outline-secondary",onClick:E},"Create"))))},Fe=function(e){var t=e.token,a=e.user,i=e.playlists,o=e.tracks,l=e.playlistsLoading,c=e.refreshPlaylist,d=e.refreshUsersPlaylists;Object(m.useTitle)("Emotionify - Sort");var f=Object(n.useState)([]),p=Object(u.a)(f,2),h=p[0],y=p[1],g=Object(n.useState)({x:"Valence",y:"Energy"}),b=Object(u.a)(g,2),v=b[0],E=b[1],k=Object(n.useState)("Distance From Origin"),w=Object(u.a)(k,2),O=w[0],j=w[1],_=Object(n.useState)([]),S=Object(u.a)(_,2),T=S[0],P=S[1],N=Object(n.useState)(!0),C=Object(u.a)(N,2),A=C[0],I=C[1],F=Object(n.useRef)(null);Object(n.useEffect)(function(){if(h.length>0){var e=h.map(function(e){return e in i?i[e].track_ids:[]}).flat(),t=Object.values(o).filter(function(t){return-1!==e.indexOf(t.id)}).sort(function(t,a){var n=e.indexOf(t.id),r=e.indexOf(a.id);return n===r?0:n>r?1:-1});P(function(e,t,a,n){var r=e.map(function(e,t){return{id:e.id,index:{before:t,after:0}}}),i=n(e.map(function(e){if(void 0!==e.audio_features&&null!==e.audio_features){var n=e.audio_features[t],r=e.audio_features[a];return{id:e.id,x:n,y:r}}return{id:e.id,x:0,y:0}})).map(function(e,t){var a=r.find(function(t){return t.id===e.id});return void 0!==a?Object(s.a)({},a,{index:{before:a.index.before,after:t}}):(console.error("[TrackTable:tracks_with_sorted_indexes] Cannot find match for: "+e.id),null)}).filter(function(e){return null!==e});return i.length!==e.length&&console.error("PointSorting.sort did not output the same amount of tracks input"),i.sort(function(e,t){return e.index.after-t.index.after})}(t,ce[v.x],ce[v.y],ee[O]))}else P([])},[h,v,O,i,o]);var M=T.filter(function(e){return void 0!==o[e.id]}),W=M.map(function(e){return o[e.id]}),B=M.map(function(e){return Object(s.a)({},o[e.id],e)}),H=r.a.createElement(x.a,{className:"mt-3 mb-4"},r.a.createElement("h1",{className:"text-center"},"Playlist Sorting"),r.a.createElement("p",{className:"text-center lead col-md-7 mx-auto"},"Here you can select a playlist and look at how the new playlist is sorted. You can then create the new playlist or select a different playlist."));return void 0===t?r.a.createElement(r.a.Fragment,null,H,r.a.createElement(x.a,{className:"text-center"},r.a.createElement("h2",null,"Sign into Spotify"),r.a.createElement("p",null,"To get access to your playlists and the ability to create playlists, you need to sign into Spotify."),r.a.createElement(L,{user:a,onLoggedInClick:function(){}}))):r.a.createElement(r.a.Fragment,null,H,r.a.createElement(x.a,{className:"text-center mb-5"},r.a.createElement(xe,{playlists:Object.values(i),selectedPlaylistIds:h,multipleSelectionsAllowed:!0,onPlaylistSelectionChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];y(e),e.forEach(function(e){0===i[e].track_ids.length&&c(i[e])}),t&&A&&setTimeout(function(){null!==F.current&&window.scroll({top:F.current.getBoundingClientRect().top+window.scrollY-50,behavior:"smooth"})},300),I(!1)}}),h.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("hr",null),r.a.createElement("div",{className:"mb-4",ref:F},r.a.createElement(we,{playlists:h.map(function(e){return e in i?i[e]:null}).filter(function(e){return null!==e}),tracksLoading:h.map(function(e){return l.has(e)}).reduce(function(e,t){return e||t})})),r.a.createElement("div",{className:"mb-3"},r.a.createElement(_e,{tracks:W,selected_x_axis:ce[v.x],selected_y_axis:ce[v.y],selected_x_axis_name:v.x,selected_y_axis_name:v.y})),r.a.createElement("div",{className:"mb-3"},r.a.createElement(Ie,{available_audio_features:Object.keys(ce),available_track_sorting_methods:Object.keys(ee),selected_x_axis:v.x,selected_y_axis:v.y,selected_sorting_method:O,onXAxisSelect:function(e){return E(Object(s.a)({},v,{x:e}))},onYAxisSelect:function(e){return E(Object(s.a)({},v,{y:e}))},onSortMethodSelect:function(e){return j(e)}})),h.map(function(e){return e in i?i[e].track_ids.length:0}).reduce(function(e,t){return e+t})>0&&h.map(function(e){return e in i?i[e].tracks.total:0}).reduce(function(e,t){return e+t})!==T.length&&r.a.createElement($.a,{variant:"warning",style:{display:"inline-block"}},"Warning: Duplicate songs will be removed in the new playlist"),r.a.createElement("div",{className:"mb-5"},r.a.createElement(Ae,{tracks:B,x_audio_feature:ce[v.x],x_audio_feature_name:v.x,y_audio_feature:ce[v.y],y_audio_feature_name:v.y})),r.a.createElement("div",{className:"mb-5"},r.a.createElement(Le,{onExport:function(e,n){return new Promise(function(){var r=Object(Q.a)(G.a.mark(function r(i,l){var c,s;return G.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===t||void 0===T||void 0===a){r.next=6;break}return c=T.map(function(e){return o[e.id].uri}),r.next=4,le(t.value,a,e,n,c).then(function(e){return d(!1),!0},function(e){return console.error(e),!1});case 4:s=r.sent,i(s);case 6:i(!1);case 7:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}})))))},Me=function(e){Object(m.useTitle)("Emotionify - Page Not Found");return r.a.createElement(x.a,{className:"text-center"},r.a.createElement("h1",{className:"my-4"},"Page Not Found"),r.a.createElement(O.a,{onClick:function(){return Object(m.navigate)("/")}},"Go Home \u2192"))};var We=function(){var e=Object(n.useState)(window.navigator.onLine),t=Object(u.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)(function(){function e(e){r(window.navigator.onLine)}return window.addEventListener("online",e),window.addEventListener("offline",e),function(){window.removeEventListener("online",e),window.removeEventListener("offline",e)}},[]),a},Be={user:void 0,playlists:{},tracks:{},audioFeatures:{}},He=function(e){var t=Object(n.useState)(void 0),a=Object(u.a)(t,2),i=a[0],o=a[1],d=Object(n.useState)(Be),h=Object(u.a)(d,2),y=h[0],g=h[1],b=Object(n.useState)(!1),v=Object(u.a)(b,2),E=v[0],k=v[1],x=Object(n.useState)(new Set),w=Object(u.a)(x,2),O=w[0],j=w[1],_=We(),S=function(e){return o(e)},T=function(){return S(void 0)},A=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];void 0!==i&&void 0!==y.user&&function(e,t){return new Promise(function(a,n){var r=new f.a;r.setAccessToken(e.value);var i=[],o=ae,l=!1;r.getUserPlaylists(t.id,{offset:0,limit:o}).then(function(){var e=Object(Q.a)(G.a.mark(function e(u){var m,d,f,p,h;return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=[].concat(Object(c.a)(i),Object(c.a)(u.items)),m=oe(o,u.total).splice(1),d=P(m,ie),f=0;case 4:if(!(f<d.length)){e.next=14;break}for(p=[],h=0;h<d[f].length;h++)p.push(r.getUserPlaylists(t.id,d[f][h]));return e.next=9,Promise.all(p).then(function(e){i=[].concat(Object(c.a)(i),Object(c.a)(e.map(function(e){return e.items}).flat()))}).catch(function(e){n(e),l=!0});case 9:if(!l){e.next=11;break}return e.abrupt("break",14);case 11:f++,e.next=4;break;case 14:a(i.map(function(e){return Object(s.a)({},e,{track_ids:[]})}));case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),function(e){n(e)})})}(i,y.user).then(function(t){g(function(a){return Object(s.a)({},a,{playlists:Object(s.a)({},N(t.map(function(t){return t.id in a.playlists&&!e?Object(s.a)({},t,{track_ids:a.playlists[t.id].track_ids}):t}),"id"))})})}).catch(function(e){return p.a.error("Could not get your playlists. Make sure you are connected to the internet and that your token is valid.",{position:"bottom-center",heading:"Error When Fetching Playlists",hideAfter:20,onClick:function(e){return e()}})})},I=function(e){void 0===i||O.has(e.id)||(j(function(t){return new Set([].concat(Object(c.a)(Array.from(t)),[e.id]))}),function(e,t){return new Promise(function(a,n){var r=new f.a;r.setAccessToken(e.value);var i=[],o=ne,l=!1;r.getPlaylistTracks(t.id,{offset:0,limit:o}).then(function(){var e=Object(Q.a)(G.a.mark(function e(u){var m,d,f,p,h;return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=[].concat(Object(c.a)(i),Object(c.a)(u.items.map(function(e){return e.track}))),m=oe(o,u.total).splice(1),d=P(m,ie),f=0;case 4:if(!(f<d.length)){e.next=14;break}for(p=[],h=0;h<d[f].length;h++)p.push(r.getPlaylistTracks(t.id,d[f][h]));return e.next=9,Promise.all(p).then(function(e){i=[].concat(Object(c.a)(i),Object(c.a)(e.map(function(e){return e.items}).flat().map(function(e){return e.track})))}).catch(function(e){n(e),l=!0});case 9:if(!l){e.next=11;break}return e.abrupt("break",14);case 11:f++,e.next=4;break;case 14:a(i.map(function(e){return Object(s.a)({},e,{audio_features:void 0})}));case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),function(e){n(e)})})}(i,e).then(function(t){g(function(a){var n=t.filter(function(e){return!(e.id in a.tracks)});return Object(s.a)({},a,{tracks:Object(s.a)({},a.tracks,N(n,"id")),playlists:Object(s.a)({},a.playlists,Object(l.a)({},e.id,Object(s.a)({},a.playlists[e.id],{track_ids:t.map(function(e){return e.id})})))})})}).catch(function(t){return p.a.error('Could not get songs for the playlist "'.concat(e.name,'". Make sure you are connected to the internet and that your token is valid.'),{position:"bottom-center",heading:"Error When Fetching Playlist's Songs",hideAfter:20,onClick:function(e){return e()}})}).finally(function(){return j(function(t){var a=new Set(t);return a.delete(e.id),a})}))};Object(n.useEffect)(function(){var e=localStorage.getItem("emotionify-app");if(null!==e)try{var t=JSON.parse(e);t.token.expiry=new Date(t.token.expiry),1===t.version&&t.token.expiry>new Date&&(o(t.token),g(Object(s.a)({},Be,{user:t.user,playlists:t.playlists})),A())}catch(a){console.error("Failed to read state from localStorage")}},[]),Object(n.useEffect)(function(){if(void 0!==i){var e={version:1,token:i,user:y.user,playlists:N(Object.values(y.playlists).map(function(e){return Object(s.a)({},e,{track_ids:[]})}),"id")};localStorage.setItem("emotionify-app",JSON.stringify(e))}else localStorage.removeItem("emotionify-app")},[i,y.user,y.playlists]),Object(n.useEffect)(function(){if(void 0===i)g(function(e){return Object(s.a)({},e,{user:void 0})});else{var e=new f.a;e.setAccessToken(i.value),e.getMe().then(function(e){void 0===y.user?g(function(t){return Object(s.a)({},t,{playlists:{},user:e})}):y.user.id!==e.id?g(function(t){return Object(s.a)({},t,{playlists:{},user:e})}):g(function(t){return Object(s.a)({},t,{user:e})})}).catch(function(e){return p.a.error("Could not get your profile. Make sure you are connected to the internet and that your token is valid.",{position:"bottom-center",heading:"Error When Fetching Your Profile",hideAfter:20,onClick:function(e){return e()}})})}},[i]),Object(n.useEffect)(function(){void 0===y.user?g(function(e){return Object(s.a)({},e,{playlists:{}})}):A()},[y.user]),Object(n.useEffect)(function(){var e=Object.values(y.tracks).filter(function(e){return void 0===e.audio_features}).map(function(e){return e.id});void 0!==i&&e.length>0&&function(e,t){return new Promise(function(){var a=Object(Q.a)(G.a.mark(function a(n,r){var i,o,l,s,u,m,d,p;return G.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:(i=new f.a).setAccessToken(e.value),o=[],l=P(t,re),s=P(l,ie),u=!1,m=0;case 7:if(!(m<s.length)){a.next=17;break}for(d=[],p=0;p<s[m].length;p++)d.push(i.getAudioFeaturesForTracks(s[m][p]));return a.next=12,Promise.all(d).then(function(e){o=[].concat(Object(c.a)(o),Object(c.a)(e.map(function(e){return e.audio_features}).flat()))}).catch(function(e){r(e),u=!0});case 12:if(!u){a.next=14;break}return a.abrupt("break",17);case 14:m++,a.next=7;break;case 17:n(o);case 18:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}())}(i,e).then(function(t){var a=N(t.filter(function(e){return null!==e}),"id"),n=e.map(function(e){return Object(s.a)({},y.tracks[e],{audio_features:e in a?a[e]:null})}),r=n.filter(function(e){return null===e.audio_features});r.length>0&&console.warn("Some audio features are null: ".concat(r.map(function(e){return e.id}).join(", "))),g(function(e){return Object(s.a)({},e,{tracks:Object(s.a)({},e.tracks,N(n,"id"))})})}).catch(function(e){return p.a.error("Could not get audio features for some songs. Make sure you are connected to the internet and that your token is valid.",{position:"bottom-center",heading:"Error When Fetching Song Audio Features",hideAfter:20,onClick:function(e){return e()}})})},[y.tracks]),Object(n.useEffect)(function(){_||p.a.warn("You are now offline. You will not be able to request data from Spotify unless you are connected to the internet.",{position:"bottom-center",heading:"Offline",hideAfter:10,onClick:function(e){return e()}})},[_]);var L={"/":function(){return r.a.createElement(z,null)},"/spotify-authorization":function(){return r.a.createElement(C,{onTokenChange:S})},"/spotify-authorization/":function(){return r.a.createElement(C,{onTokenChange:S})},"/sort":function(){return r.a.createElement(Fe,{token:i,user:y.user,playlists:y.playlists,tracks:y.tracks,playlistsLoading:O,refreshPlaylist:I,refreshUsersPlaylists:A})},"/about":function(){return r.a.createElement(q,null)}},F=Object(m.useRoutes)(L);return Object(m.useRedirect)("/sort/","/sort"),Object(m.useRedirect)("/about/","/about"),r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{token:i,onLogOut:T}),void 0!==i&&void 0!==y.user&&E&&r.a.createElement(R,{token:i,user:y.user,playlists:y.playlists,tracks:y.tracks,onClose:function(){return k(!1)},onLogOut:T}),r.a.createElement(M,{user:y.user,onAuthButtonLoggedInClick:function(){return k(!0)}}),F||r.a.createElement(Me,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(He,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},43:function(e,t,a){e.exports=a.p+"static/media/banner.ed08e733.png"},61:function(e){e.exports={spotify_client_id:"3d402278ec5e45bc930e791de2741b3e",spotify_premission_scope:"playlist-read-private user-read-private playlist-modify-private playlist-modify-public"}},91:function(e,t,a){e.exports=a.p+"static/media/spotify-logo-round.d154494c.png"},92:function(e,t,a){e.exports=a.p+"static/media/sort-comparison.5fbd2110.png"},97:function(e,t,a){e.exports=a(173)}},[[97,1,2]]]);
//# sourceMappingURL=main.b4292537.chunk.js.map